{% extends 'base.html' %}

{% block content %}   

{% load crispy_forms_tags %}

<br>
<div class="container bg-light card shadow-md p-5 shadow p-3 mb-5 form-layout">
                
    <h1 class="text-center">Registro Antropométrico</h1>
    <h5 class="text-center">Agrege los datos requerido para su registro</h5>
    <hr>


    {{error}}


    <div class="tabcontent" id="metric">

            <div class="row">

                <div class="col">
                    <P> <strong> Cédula: </strong> {{beneficiarios.cedula}} </p>
                </div>
                <div class="col">
                    <P> <strong> Nombre: </strong>{{beneficiarios.nombre}}</p> 
                </div>
                <div class="col">
                    <P> <strong> Apellido: </strong> {{beneficiarios.apellido}} </p>
                </div>
            </div>

            {% if beneficiarios.embarazada == "SI" %}
                <div class="row">
                    <div class="col-6">
                        <P> <strong> Tiempo del Embarazo: </strong> {{imc_beneficiarios.tiempo}} </p>
                    </div>
                </div> 
         
            {% elif beneficiarios.lactando == "SI" %}
                <div class="row">
                    <div class="col-6">
                        <P> <strong> Tiempo Lactando: </strong> {{imc_beneficiarios.tiempo}} </p>
                    </div>
                </div> 

            {% endif %}
            <div class="row">
                <div class="col-4">
                    <P> <strong> Peso: </strong> {{imc_beneficiarios.peso}} </p>
                </div>

                <div class="col-4">
                    <P> <strong> Talla: </strong> {{imc_beneficiarios.talla}} </p>
                </div>

                <div class="col-4">
                    <P> <strong> CBI: </strong> {{imc_beneficiarios.cbi}} </p>
                </div>
            </div>

            <div class="row">
                <div class="col-sm-6">
                    <div id="main" style="width: 400px;height:300px;"></div>

                    <script type="text/javascript">
                        var chartDom = document.getElementById('main');
                        var myChart = echarts.init(chartDom);
                        var datos = {{imc}};
                        var option;
                        option = {
                            series: [
                              {
                                type: 'gauge',
                                startAngle: 180,
                                endAngle: 0,
                                center: ['50%', '75%'],
                                radius: '90%',
                                min: 0,
                                max: 1,
                                splitNumber: 8,
                                axisLine: {
                                  lineStyle: {
                                    width: 6,
                                    color: [
                                      [0.25, '#FF6E76'],
                                      [0.5, '#FDDD60'],
                                      [0.75, '#58D9F9'],
                                      [1, '#7CFFB2']
                                    ]
                                  }
                                },
                                pointer: {
                                  icon: 'path://M12.8,0.7l12,40.1H0.7L12.8,0.7z',
                                  length: '12%',
                                  width: 20,
                                  offsetCenter: [0, '-60%'],
                                  itemStyle: {
                                    color: 'auto'
                                  }
                                },
                                axisTick: {
                                  length: 12,
                                  lineStyle: {
                                    color: 'auto',
                                    width: 2
                                  }
                                },
                                splitLine: {
                                  length: 20,
                                  lineStyle: {
                                    color: 'auto',
                                    width: 5
                                  }
                                },
                                axisLabel: {
                                  color: '#464646',
                                  fontSize: 14,
                                  distance: -60,
                                  rotate: 'tangential',
                                  formatter: function (value) {
                                    if (value === 0.875) {
                                      return 'Grade A';
                                    } else if (value === 0.625) {
                                      return 'Grade B';
                                    } else if (value === 0.375) {
                                      return 'Grade C';
                                    } else if (value === 0.125) {
                                      return 'Grade D';
                                    }
                                    return '';
                                  }
                                },
                                title: {
                                  offsetCenter: [0, '-10%'],
                                  fontSize: 14
                                },
                                detail: {
                                  fontSize: 30,
                                  offsetCenter: [0, '-35%'],
                                  valueAnimation: true,
                                  formatter: function (value) {
                                    return Math.round(value * 100) + '';
                                  },
                                  color: 'inherit'
                                },
                                data: [
                                  {
                                    value: datos,
                                    
                                  }
                                ]
                              }
                            ]
                          };
            
                          option && myChart.setOption(option);
                        </script>


                </div>

            </div>

    </div>

    {% if imc_beneficiarios.imc %}
        <div class="row">
            <div  class="text-center" >
                <h2>Resultado</h2>
                <p> Su IMC = {{imc_beneficiarios.imc}} Kg/m² </p>

                {% if imc_beneficiarios.diagnostico == "PESO BAJO" %}
                    <div class="text-bg-danger p-2">PESO BAJO</div>  
                {%elif imc_beneficiarios.diagnostico == "ADECUADO" %}
                    <div class="text-bg-success p-2">ADECUADO</div>
                {%elif imc_beneficiarios.diagnostico == "RIESGO DE SOBREPESO" %}
                    <div class="text-bg-warning p-2">RIESGO DE SOBREPESO</div>
                {%elif imc_beneficiarios.diagnostico == "SOBREPESO" %}
                    <div class="text-white p-2"style="background-color:#FF7F50">SOBREPESO</div>
                {%elif imc_beneficiarios.diagnostico == "OBESIDAD" %}
                    <div class="text-bg-danger p-2">OBESIDAD</div>
                {% endif %}
            </div>
        </div>
        <br>

        <form action="imc_benef_riesgo" method="POST">
            {% csrf_token %}
    
            <div class="row justify-content-center">
                <div class="col-5 text-center">
                    <label for="riesgo">Presenta Riesgo:</label>
                    <select id="riesgo" name="riesgo">
                        <option value="NO" selected>NO</option>
                        <option value="SI">SI</option>
                    </select>
                </div>
            </div> 
            
            <div class="row">
                <div class="col">
                    <label for="servicio">Servicio:</label>
                    <textarea name="servicio" rows="6" cols="12"></textarea>
                </div>
                <div class="col">
                    <label for="centro_hospital">Centro:</label>
                    <textarea name="centro_hospital" rows="6" cols="12"></textarea>
                </div>
                <div class="col">
                    <label for="observacion">Observación:</label>
                    <textarea name="observacion" rows="6" cols="12"></textarea>
                </div>
            </div> 
            
            <br>
            <button type="submit" class="btn btn-primary" action="{% url 'beneficiario_detalle' pk %}">Aceptar </button>

        </form>


    {% endif %}

</div>

{% endblock %}



